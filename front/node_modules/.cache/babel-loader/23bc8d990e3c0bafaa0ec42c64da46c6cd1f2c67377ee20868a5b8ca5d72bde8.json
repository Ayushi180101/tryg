{"ast":null,"code":"\"use strict\";\n\n/**\n * Copyright 2024 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.PermissionsProcessor = void 0;\nconst protocol_js_1 = require(\"../../../protocol/protocol.js\");\nclass PermissionsProcessor {\n  #browserCdpClient;\n  constructor(browserCdpClient) {\n    this.#browserCdpClient = browserCdpClient;\n  }\n  async setPermissions(params) {\n    try {\n      const userContextId = params['goog:userContext'];\n      await this.#browserCdpClient.sendCommand('Browser.setPermission', {\n        origin: params.origin,\n        browserContextId: userContextId && userContextId !== 'default' ? userContextId : undefined,\n        permission: {\n          name: params.descriptor.name\n        },\n        setting: params.state\n      });\n    } catch (err) {\n      if (err.message === `Permission can't be granted to opaque origins.`) {\n        // Return success if the origin is not valid (does not match any\n        // existing origins).\n        return {};\n      }\n      throw new protocol_js_1.InvalidArgumentException(err.message);\n    }\n    return {};\n  }\n}\nexports.PermissionsProcessor = PermissionsProcessor;","map":{"version":3,"names":["protocol_js_1","require","PermissionsProcessor","browserCdpClient","constructor","setPermissions","params","userContextId","sendCommand","origin","browserContextId","undefined","permission","name","descriptor","setting","state","err","message","InvalidArgumentException","exports"],"sources":["../../../../../src/bidiMapper/domains/permissions/PermissionsProcessor.ts"],"sourcesContent":[null],"mappings":";;AAAA;;;;;;;;;;;;;;;;;;;;AAkBA,MAAAA,aAAA,GAAAC,OAAA;AAMA,MAAaC,oBAAoB;EAC/B,CAAAC,gBAAiB;EAEjBC,YAAYD,gBAA2B;IACrC,IAAI,CAAC,CAAAA,gBAAiB,GAAGA,gBAAgB;EAC3C;EAEA,MAAME,cAAcA,CAClBC,MAA2C;IAE3C,IAAI;MACF,MAAMC,aAAa,GAAID,MAAwC,CAC7D,kBAAkB,CACnB;MACD,MAAM,IAAI,CAAC,CAAAH,gBAAiB,CAACK,WAAW,CAAC,uBAAuB,EAAE;QAChEC,MAAM,EAAEH,MAAM,CAACG,MAAM;QACrBC,gBAAgB,EACdH,aAAa,IAAIA,aAAa,KAAK,SAAS,GACxCA,aAAa,GACbI,SAAS;QACfC,UAAU,EAAE;UACVC,IAAI,EAAEP,MAAM,CAACQ,UAAU,CAACD;SACzB;QACDE,OAAO,EAAET,MAAM,CAACU;OACjB,CAAC;IACJ,CAAC,CAAC,OAAOC,GAAG,EAAE;MACZ,IACGA,GAAa,CAACC,OAAO,KACtB,gDAAgD,EAChD;QACA;QACA;QACA,OAAO,EAAE;MACX;MACA,MAAM,IAAIlB,aAAA,CAAAmB,wBAAwB,CAAEF,GAAa,CAACC,OAAO,CAAC;IAC5D;IACA,OAAO,EAAE;EACX;;AArCFE,OAAA,CAAAlB,oBAAA,GAAAA,oBAAA","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}